{"version":3,"file":"internal-property-validation-rule.js","sourceRoot":"","sources":["../src/internal-property-validation-rule.ts"],"names":[],"mappings":"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","sourcesContent":["import { ValidationRule } from \"./validation-rule\";\nimport { Validator } from \"./validator\";\nimport { given } from \"@nivinjoseph/n-defensive\";\nimport { InvalidOperationException } from \"@nivinjoseph/n-exception\";\n\n// internal\nexport class InternalPropertyValidationRule<T, TProperty>\n{\n    private _tpropertyValidationPredicate: (propertyValue: TProperty) => boolean = null;\n    private _tValidationPredicate: (value: T) => boolean = null;\n    private _validationRule: ValidationRule<TProperty> = null;\n    private _validator: Validator<TProperty> = null;\n    private _conditionPredicate: (value: T) => boolean = null;\n    private _error: string | Function;\n    private _overrideError = false;\n    \n\n    public get error(): Object\n    {\n        if (this._validationRule != null && !this._overrideError)\n            return this._validationRule.error;\n        else if (this._validator != null && !this._overrideError)\n            return this._validator.errors;\n        else return typeof this._error === \"function\" ? this._error() : this._error;\n    }\n    \n    public get overrideError(): boolean { return this._overrideError; }\n\n\n    public ensure(tpropertyValidationPredicate: (propertyValue: TProperty) => boolean): void\n    {\n        given(tpropertyValidationPredicate, \"tpropertyValidationPredicate\").ensureHasValue();\n\n        this._tpropertyValidationPredicate = tpropertyValidationPredicate;\n        this._error = \"Invalid value\";\n    }\n\n    public ensureT(tValidationPredicate: (value: T) => boolean): void\n    {\n        given(tValidationPredicate, \"tValidationPredicate\").ensureHasValue();\n\n        this._tValidationPredicate = tValidationPredicate;\n        this._error = \"Invalid value\";\n    }\n\n    public useValidationRule(validationRule: ValidationRule<TProperty>): void\n    {\n        given(validationRule, \"validationRule\").ensureHasValue();\n\n        this._validationRule = validationRule;\n    }\n\n    public useValidator(validator: Validator<TProperty>): void\n    {\n        given(validator, \"validator\").ensureHasValue();\n\n        this._validator = validator;\n    }\n\n    public if(conditionPredicate: (value: T) => boolean): void\n    {\n        given(conditionPredicate, \"conditionPredicate\").ensureHasValue();\n\n        this._conditionPredicate = conditionPredicate;\n    }\n\n    public withMessage(errorMessage: string | Function, overrideError = false): void\n    {\n        given(errorMessage, \"errorMessage\").ensureHasValue();\n\n        this._error = errorMessage;\n        this._overrideError = overrideError;\n    }\n\n    public validate(value: T, propertyValue: TProperty): boolean\n    {\n        if (this._conditionPredicate != null && !this._conditionPredicate(value))\n            return true;\n\n        if (this._tpropertyValidationPredicate != null)\n            return this._tpropertyValidationPredicate(propertyValue);\n\n        if (this._tValidationPredicate != null)\n            return this._tValidationPredicate(value);\n\n        if (this._validationRule != null)\n            return this._validationRule.validate(propertyValue);\n\n        if (this._validator != null)\n        {\n            this._validator.validate(propertyValue);\n            return this._validator.isValid;\n        }\n\n        throw new InvalidOperationException(\"Validate\");\n    }\n}"]}